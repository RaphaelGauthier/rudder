
<lift:surround with="common-layout" at="content">

  <head>
    <title>Rudder - Global parameters</title>
    <style>
    .rudder-template .one-col{
      width: 100%;
    }
    .template-main{
      flex-basis : initial !important;
      flex: auto !important;
    }
    .callout-fade.callout-info {
      margin-top: 10px;
      min-height: 80px;
    }
    #.dataTable{
      table-layout:fixed;
    }
    .dataTable .json-beautify{
      padding:0;
      max-height: initial;
    }
    .dataTable .json-beautify:after{
      content:"";
    }
    </style>
  </head>

  <div class="rudder-template">
    <div class="one-col">
      <div class="main-header">
        <div class="header-title">
          <h1>
            <span>Global Parameters</span>
          </h1>
        </div>
        <div class="header-description">
          <p>
            Global Parameters are key/value pairs. Once defined, they will be inherited by group properties and node properties,
            you can use them in directive parameters.
          </p>
        </div>
      </div>
      <div class="one-col-main">
        <div class="template-main">
          <div class="main-container">
            <div class="main-details">
              <lift:authz role="directive_read">
                <div class="callout-fade callout-info">
                  <div class="marker">
                    <span class="glyphicon glyphicon-info-sign"></span>
                  </div>
                  <div>
                    <p>
                      The syntax to use a parameter is the same as using a node property <b>${node.properties&lsqb;key&rsqb;}</b>, where &lt;key&gt;
                      is the name you chose for your Global Parameter.
                    </p>
                    <p>
                      Be careful to enter exactly <b>node.properties</b> (lower case) and your parameter name with the same case
                      (Global Parameter keys are case sensitive). Also, remember that their value can be overriden by group and node properties.
                    </p>
                  </div>
                </div>

                <div id="parameters-app" ></div>

                <!--
                <div class="inner-portlet-content">
                  <div class="lift:configuration.ParameterManagement.display"></div>
                </div>
                -->

              </lift:authz>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!--
    <div id="createGlobalParameterPopup" class="modal fade" data-keyboard="true" tabindex="-1">
      <lift:ignore>
        This div gets the content of the CreateOrUpdateGlobalParameterPopup injected within
      </lift:ignore>
      <div id="createGlobalParameterContainer"></div>
    </div>
    <div id="deletionPopup" class="nodisplay"></div>
    -->

  </div>

  <script data-lift="with-cached-resource" src="/javascript/rudder/elm/rudder-parameters.js"></script>
  <script>
    var hasWriteRights = false;
  </script>
  <lift:authz role="directive_write">
    <script>
      var hasWriteRights = true;
    </script>
  </lift:authz>

  <script>
    $(document).ready(function(){
      var main = document.getElementById("parameters-app")
      var initValues = {
        contextPath    : contextPath
      , hasWriteRights : hasWriteRights
      };

      var app = Elm.Parameters.init({node: main, flags: initValues});

      app.ports.successNotification.subscribe(function(str) {
        createSuccessNotification(str)
      });

      app.ports.errorNotification.subscribe(function(str) {
        createErrorNotification(str)
      });

      app.ports.copy.subscribe(function(str) {
        navigator.clipboard.writeText(str);
      });

      // Initialize tooltips
      app.ports.initTooltips.subscribe(function(msg) {
        setTimeout(function(){
          $('.bs-tooltip').bsTooltip();
        }, 200);
      });

    });
  </script>

</lift:surround>
